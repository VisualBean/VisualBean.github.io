<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/site.css">
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/swfobject.js"></script>
    <script src="js/browserdetect.js"></script>
    <script src="js/knockout-3.3.0.js"></script>
    <title>
        WiseFlow Compatibility Checker
    </title>
</head>
<body>
<div class="col-xs-12">
    <div class="topalert">
        <div id="alert">
            <p>Flash Version: <strong data-bind="text: flashVersion"></strong> <strong id="flashstatus"></strong></p>
            <p>Browser Version: <strong data-bind="text: browserVersion"></strong> <strong id="browserstatus"></strong></p>
        </div>
    </div>
    <div class="finalstatus">
        <strong style="font-size: 250px" id="finalstatus"></strong>
    </div>
</div>
</body>
<footer id="footer">
    <div class="finalstatustext"></div>
</footer>
</html>
<script type="text/javascript">
    function AppViewModel() {
        var self = this;
        var browser = get_browser_info();
        var flash = swfobject.getFlashPlayerVersion();

        self.flashVersion = flash.major + "." + flash.minor;
        self.browserVersion = browser.name + " " + browser.version;
        var browserSuccess = false;
        var flashSuccess = false;
        var bVersion = parseInt(browser.version);
        if (flash.major >= 10) {
            flashSuccess = SetFlashSuccess();
        }
        else
        {
            flashSuccess = SetFlashUnSuccessful();
        }

        //Do check for browsers as well
        if(browser.name == "IE " && bVersion >= 10)
        {
            browserSuccess = SetBrowserSuccess();
        }
        if(browser.name == "Firefox" && bVersion >= 20)
        {
            browserSuccess = SetBrowserSuccess();
        }
        if(browser.name == "Safari" && bVersion >= 6)
        {}
        if(browser.name == "Chrome" && bVersion >= 25)
        {}
        if(browser.name == "Opera" && bVersion >= 12)
        {}

        var statustext = "You will have no trouble using WiseFlow.";
        if(!browserSuccess){
        statustext = "Please update your browser to a newer version.";
        }
        if(!flashSuccess)
        {
           statustext += '<br> You can get the newest version of flash <a href="https://get.adobe.com/flashplayer/">here.</a></br>';
        }

        $('.finalstatustext').html(statustext);

        var success = browserSuccess && flashSuccess;

        if (success == true) {
            SetAlert(true);
            GreenCheckmark("finalstatus");
        }
        else {
            SetAlert(false);
            RedCross("finalstatus")
        }

    }
    ;
    ko.applyBindings(new AppViewModel());

    function SetAlert(b) {
        if (b == true) {
            document.getElementById("alert").className = "alert alert-success";
            document.getElementById("alert").role = "alert";
        }
        else {
            document.getElementById("alert").className = "alert alert-danger";
            document.getElementById("alert").role = "alert";
        }
    }
    function SetFlashSuccess() {
        GreenCheckmark("flashstatus");
        return true;
    }
    function SetFlashUnSuccessful() {

        RedCross("flashstatus")

        return false;
    }
    function SetBrowserSuccess() {
        GreenCheckmark("browserstatus");
        return true;
    }
    function SetBrowserUnSuccessful() {

        RedCross("browserstatus")
        return false;
    }

    function GreenCheckmark(id) {
        $("#" + id).html('&#10003;');
        document.getElementById(id).style.color = "#27ae60";
    }
    function RedCross(id) {
        $("#" + id).html('&#10005;');
        document.getElementById(id).style.color = "#c0392b";
    }
    function SetText(text) {
        $("#text").html(text);
    }
</script>